@using System.Web.UI.WebControls
@model IEnumerable<NutricionWeb.Models.Turno.TurnoViewModel>

@{
    ViewBag.Title = "Calendario";
}
<h2>@ViewBag.Title.</h2>
<h3>@ViewBag.Message</h3>
<div id="calendar"></div>
<link href="~/Content/fullcalendar.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.12.4.js"></script>
<script src="~/Scripts/fullcalendar/fullcalendar.js"></script>
<script src="~/Scripts/fullcalendar/lang/es.js"></script>

<script>
    $(document).ready(function () {
        var events = [];
        fetchEventAndRenderCalendar();
        // page is now ready, initialize the calendar...

        
        function fetchEventAndRenderCalendar() {
            events = [];
        $.ajax({
            type: "GET",
            url: "/turno/GetTurnos",
            success: function(data) {
                $.each(data,
                    function(i, v) {
                        events.push({
                            eventID: v.Id,
                            title: v.PacienteStr,
                            description: v.Motivo,
                            start: moment(v.HorarioEntrada),
                            pacienteID: v.PacienteId,
                        });
                    });
                generateCalender(events);
            }
            });
           }
        function generateCalender(events) {
            $('#calendar').fullCalendar({
                contentHeight: 500,
                defaultDate: new Date(),
                timeFormat: 'h(:mm)a',
                eventLimit: true,
                eventColor: '#378006',
                events: events
            })
        }
    });
</script>